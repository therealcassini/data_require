import{a as V}from"./index-B9ygI19o.js";import{_ as A,c as Y,b as F,a as n,w as l,d as r,r as m,t as I,e as k,h as D,f as B,g,o as N}from"./index-YvoSsj8_.js";const U=V.create({baseURL:"/api",headers:{"Content-Type":"application/json"}}),E={getRequirements(){return U.get("/requirements")},getRequirement(s){return U.get(`/requirements/${s}`)},createRequirement(s){return U.post("/requirements",s)},updateRequirement(s,e){return U.put(`/requirements/${s}`,e)},deleteRequirement(s){return U.delete(`/requirements/${s}`)}},j={name:"Requirements",setup(){const s=k([]),e=k(!1),o=D({category:"",section:"",requirement_name:"",is_connected:0,department:"",data_system:"",data_name:"",data_quality:"",data_status:"",need_coordination:0,next_plan:"",planned_time:null,remarks:""}),t=k(null),y=k(!1),b=D({id:null,category:"",section:"",requirement_name:"",is_connected:0,department:"",data_system:"",data_name:"",data_quality:"",data_status:"",need_coordination:0,next_plan:"",planned_time:null,remarks:""}),x=k(null),w={category:[{required:!0,message:"请输入大类",trigger:"blur"}],section:[{required:!0,message:"请输入版块",trigger:"blur"}],requirement_name:[{required:!0,message:"请输入需求名目",trigger:"blur"}]},c=[{title:"大类",dataIndex:"category",key:"category"},{title:"版块",dataIndex:"section",key:"section"},{title:"需求名目",dataIndex:"requirement_name",key:"requirement_name"},{title:"是否已对接",dataIndex:"is_connected",key:"is_connected",slots:{customRender:"is_connected"}},{title:"对接部门",dataIndex:"department",key:"department"},{title:"对接数据系统",dataIndex:"data_system",key:"data_system"},{title:"对接数据名称",dataIndex:"data_name",key:"data_name"},{title:"已对接数据质量",dataIndex:"data_quality",key:"data_quality"},{title:"是否需要业主协调",dataIndex:"need_coordination",key:"need_coordination",slots:{customRender:"need_coordination"}},{title:"计划对接时间",dataIndex:"planned_time",key:"planned_time"},{title:"操作",key:"action",slots:{customRender:"action"}}],p=()=>{E.getRequirements().then(i=>{s.value=i.data}).catch(i=>{g.error("获取需求列表失败"),console.error("Error fetching requirements:",i)})},u=()=>{e.value=!0},d=()=>{t.value.validate().then(()=>{const i={...o};i.planned_time&&(i.planned_time=i.planned_time.format("YYYY-MM-DD")),E.createRequirement(i).then(()=>{g.success("添加需求成功"),e.value=!1,p(),R()}).catch(f=>{g.error("添加需求失败"),console.error("Error creating requirement:",f)})}).catch(()=>{})},_=()=>{e.value=!1,R()},R=()=>{o.category="",o.section="",o.requirement_name="",o.is_connected=0,o.department="",o.data_system="",o.data_name="",o.data_quality="",o.data_status="",o.need_coordination=0,o.next_plan="",o.planned_time=null,o.remarks=""},v=i=>{Object.assign(b,i),i.planned_time&&(b.planned_time=new Date(i.planned_time)),y.value=!0},C=()=>{x.value.validate().then(()=>{const i={...b};i.planned_time&&(i.planned_time=i.planned_time.format("YYYY-MM-DD")),E.updateRequirement(i.id,i).then(()=>{g.success("更新需求成功"),y.value=!1,p()}).catch(f=>{g.error("更新需求失败"),console.error("Error updating requirement:",f)})}).catch(()=>{})},q=()=>{y.value=!1},M=i=>{E.deleteRequirement(i).then(()=>{g.success("删除需求成功"),p()}).catch(f=>{g.error("删除需求失败"),console.error("Error deleting requirement:",f)})};return B(()=>{p()}),{requirements:s,columns:c,addModalVisible:e,newRequirement:o,addFormRef:t,editModalVisible:y,editingRequirement:b,editFormRef:x,rules:w,showAddModal:u,handleAddOk:d,handleAddCancel:_,showEditModal:v,handleEditOk:C,handleEditCancel:q,handleDelete:M}}},T={class:"requirements-container"};function L(s,e,o,t,y,b){const x=m("a-icon"),w=m("a-button"),c=m("a-tag"),p=m("a-table"),u=m("a-input"),d=m("a-form-item"),_=m("a-radio"),R=m("a-radio-group"),v=m("a-select-option"),C=m("a-select"),q=m("a-textarea"),M=m("a-date-picker"),i=m("a-form"),f=m("a-modal");return N(),Y("div",T,[e[47]||(e[47]=F("h2",null,"需求管理",-1)),n(w,{type:"primary",onClick:t.showAddModal,style:{"margin-bottom":"16px"}},{default:l(()=>[n(x,{type:"plus"}),e[28]||(e[28]=r(" 添加需求 ",-1))]),_:1},8,["onClick"]),n(p,{columns:t.columns,"data-source":t.requirements,pagination:!1,"row-key":"id",bordered:""},{action:l(({record:a})=>[n(w,{type:"link",onClick:O=>t.showEditModal(a)},{default:l(()=>[...e[29]||(e[29]=[r(" 编辑 ",-1)])]),_:1},8,["onClick"]),n(w,{type:"link",danger:"",onClick:O=>t.handleDelete(a.id)},{default:l(()=>[...e[30]||(e[30]=[r(" 删除 ",-1)])]),_:1},8,["onClick"])]),is_connected:l(({record:a})=>[n(c,{color:a.is_connected?"green":"red"},{default:l(()=>[r(I(a.is_connected?"已对接":"未对接"),1)]),_:2},1032,["color"])]),need_coordination:l(({record:a})=>[n(c,{color:a.need_coordination?"red":"green"},{default:l(()=>[r(I(a.need_coordination?"需要":"不需要"),1)]),_:2},1032,["color"])]),_:1},8,["columns","data-source"]),n(f,{title:"添加需求",visible:t.addModalVisible,"onUpdate:visible":e[13]||(e[13]=a=>t.addModalVisible=a),onOk:t.handleAddOk,onCancel:t.handleAddCancel},{default:l(()=>[n(i,{model:t.newRequirement,rules:t.rules,ref:"addFormRef"},{default:l(()=>[n(d,{label:"大类",name:"category"},{default:l(()=>[n(u,{value:t.newRequirement.category,"onUpdate:value":e[0]||(e[0]=a=>t.newRequirement.category=a),placeholder:"请输入大类"},null,8,["value"])]),_:1}),n(d,{label:"版块",name:"section"},{default:l(()=>[n(u,{value:t.newRequirement.section,"onUpdate:value":e[1]||(e[1]=a=>t.newRequirement.section=a),placeholder:"请输入版块"},null,8,["value"])]),_:1}),n(d,{label:"需求名目",name:"requirement_name"},{default:l(()=>[n(u,{value:t.newRequirement.requirement_name,"onUpdate:value":e[2]||(e[2]=a=>t.newRequirement.requirement_name=a),placeholder:"请输入需求名目"},null,8,["value"])]),_:1}),n(d,{label:"是否已对接"},{default:l(()=>[n(R,{value:t.newRequirement.is_connected,"onUpdate:value":e[3]||(e[3]=a=>t.newRequirement.is_connected=a)},{default:l(()=>[n(_,{value:"0"},{default:l(()=>[...e[31]||(e[31]=[r("否",-1)])]),_:1}),n(_,{value:"1"},{default:l(()=>[...e[32]||(e[32]=[r("是",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"对接部门"},{default:l(()=>[n(u,{value:t.newRequirement.department,"onUpdate:value":e[4]||(e[4]=a=>t.newRequirement.department=a),placeholder:"请输入对接部门"},null,8,["value"])]),_:1}),n(d,{label:"对接数据系统"},{default:l(()=>[n(u,{value:t.newRequirement.data_system,"onUpdate:value":e[5]||(e[5]=a=>t.newRequirement.data_system=a),placeholder:"请输入对接数据系统"},null,8,["value"])]),_:1}),n(d,{label:"对接数据名称"},{default:l(()=>[n(u,{value:t.newRequirement.data_name,"onUpdate:value":e[6]||(e[6]=a=>t.newRequirement.data_name=a),placeholder:"请输入对接数据名称"},null,8,["value"])]),_:1}),n(d,{label:"已对接数据质量"},{default:l(()=>[n(C,{value:t.newRequirement.data_quality,"onUpdate:value":e[7]||(e[7]=a=>t.newRequirement.data_quality=a),placeholder:"请选择数据质量"},{default:l(()=>[n(v,{value:"优"},{default:l(()=>[...e[33]||(e[33]=[r("优",-1)])]),_:1}),n(v,{value:"良"},{default:l(()=>[...e[34]||(e[34]=[r("良",-1)])]),_:1}),n(v,{value:"中"},{default:l(()=>[...e[35]||(e[35]=[r("中",-1)])]),_:1}),n(v,{value:"差"},{default:l(()=>[...e[36]||(e[36]=[r("差",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"已对接数据情况"},{default:l(()=>[n(q,{value:t.newRequirement.data_status,"onUpdate:value":e[8]||(e[8]=a=>t.newRequirement.data_status=a),placeholder:"请输入已对接数据情况",rows:3},null,8,["value"])]),_:1}),n(d,{label:"是否需要业主协调"},{default:l(()=>[n(R,{value:t.newRequirement.need_coordination,"onUpdate:value":e[9]||(e[9]=a=>t.newRequirement.need_coordination=a)},{default:l(()=>[n(_,{value:"0"},{default:l(()=>[...e[37]||(e[37]=[r("否",-1)])]),_:1}),n(_,{value:"1"},{default:l(()=>[...e[38]||(e[38]=[r("是",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"下一步计划"},{default:l(()=>[n(q,{value:t.newRequirement.next_plan,"onUpdate:value":e[10]||(e[10]=a=>t.newRequirement.next_plan=a),placeholder:"请输入下一步计划",rows:3},null,8,["value"])]),_:1}),n(d,{label:"计划对接时间"},{default:l(()=>[n(M,{value:t.newRequirement.planned_time,"onUpdate:value":e[11]||(e[11]=a=>t.newRequirement.planned_time=a),style:{width:"100%"}},null,8,["value"])]),_:1}),n(d,{label:"备注"},{default:l(()=>[n(q,{value:t.newRequirement.remarks,"onUpdate:value":e[12]||(e[12]=a=>t.newRequirement.remarks=a),placeholder:"请输入备注",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk","onCancel"]),n(f,{title:"编辑需求",visible:t.editModalVisible,"onUpdate:visible":e[27]||(e[27]=a=>t.editModalVisible=a),onOk:t.handleEditOk,onCancel:t.handleEditCancel},{default:l(()=>[n(i,{model:t.editingRequirement,rules:t.rules,ref:"editFormRef"},{default:l(()=>[n(d,{label:"大类",name:"category"},{default:l(()=>[n(u,{value:t.editingRequirement.category,"onUpdate:value":e[14]||(e[14]=a=>t.editingRequirement.category=a),placeholder:"请输入大类"},null,8,["value"])]),_:1}),n(d,{label:"版块",name:"section"},{default:l(()=>[n(u,{value:t.editingRequirement.section,"onUpdate:value":e[15]||(e[15]=a=>t.editingRequirement.section=a),placeholder:"请输入版块"},null,8,["value"])]),_:1}),n(d,{label:"需求名目",name:"requirement_name"},{default:l(()=>[n(u,{value:t.editingRequirement.requirement_name,"onUpdate:value":e[16]||(e[16]=a=>t.editingRequirement.requirement_name=a),placeholder:"请输入需求名目"},null,8,["value"])]),_:1}),n(d,{label:"是否已对接"},{default:l(()=>[n(R,{value:t.editingRequirement.is_connected,"onUpdate:value":e[17]||(e[17]=a=>t.editingRequirement.is_connected=a)},{default:l(()=>[n(_,{value:"0"},{default:l(()=>[...e[39]||(e[39]=[r("否",-1)])]),_:1}),n(_,{value:"1"},{default:l(()=>[...e[40]||(e[40]=[r("是",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"对接部门"},{default:l(()=>[n(u,{value:t.editingRequirement.department,"onUpdate:value":e[18]||(e[18]=a=>t.editingRequirement.department=a),placeholder:"请输入对接部门"},null,8,["value"])]),_:1}),n(d,{label:"对接数据系统"},{default:l(()=>[n(u,{value:t.editingRequirement.data_system,"onUpdate:value":e[19]||(e[19]=a=>t.editingRequirement.data_system=a),placeholder:"请输入对接数据系统"},null,8,["value"])]),_:1}),n(d,{label:"对接数据名称"},{default:l(()=>[n(u,{value:t.editingRequirement.data_name,"onUpdate:value":e[20]||(e[20]=a=>t.editingRequirement.data_name=a),placeholder:"请输入对接数据名称"},null,8,["value"])]),_:1}),n(d,{label:"已对接数据质量"},{default:l(()=>[n(C,{value:t.editingRequirement.data_quality,"onUpdate:value":e[21]||(e[21]=a=>t.editingRequirement.data_quality=a),placeholder:"请选择数据质量"},{default:l(()=>[n(v,{value:"优"},{default:l(()=>[...e[41]||(e[41]=[r("优",-1)])]),_:1}),n(v,{value:"良"},{default:l(()=>[...e[42]||(e[42]=[r("良",-1)])]),_:1}),n(v,{value:"中"},{default:l(()=>[...e[43]||(e[43]=[r("中",-1)])]),_:1}),n(v,{value:"差"},{default:l(()=>[...e[44]||(e[44]=[r("差",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"已对接数据情况"},{default:l(()=>[n(q,{value:t.editingRequirement.data_status,"onUpdate:value":e[22]||(e[22]=a=>t.editingRequirement.data_status=a),placeholder:"请输入已对接数据情况",rows:3},null,8,["value"])]),_:1}),n(d,{label:"是否需要业主协调"},{default:l(()=>[n(R,{value:t.editingRequirement.need_coordination,"onUpdate:value":e[23]||(e[23]=a=>t.editingRequirement.need_coordination=a)},{default:l(()=>[n(_,{value:"0"},{default:l(()=>[...e[45]||(e[45]=[r("否",-1)])]),_:1}),n(_,{value:"1"},{default:l(()=>[...e[46]||(e[46]=[r("是",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n(d,{label:"下一步计划"},{default:l(()=>[n(q,{value:t.editingRequirement.next_plan,"onUpdate:value":e[24]||(e[24]=a=>t.editingRequirement.next_plan=a),placeholder:"请输入下一步计划",rows:3},null,8,["value"])]),_:1}),n(d,{label:"计划对接时间"},{default:l(()=>[n(M,{value:t.editingRequirement.planned_time,"onUpdate:value":e[25]||(e[25]=a=>t.editingRequirement.planned_time=a),style:{width:"100%"}},null,8,["value"])]),_:1}),n(d,{label:"备注"},{default:l(()=>[n(q,{value:t.editingRequirement.remarks,"onUpdate:value":e[26]||(e[26]=a=>t.editingRequirement.remarks=a),placeholder:"请输入备注",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk","onCancel"])])}const G=A(j,[["render",L],["__scopeId","data-v-2997be86"]]);export{G as default};
