import{a as h}from"./index-B9ygI19o.js";import{_ as E,D as I,E as D,P as V,c as P,a,w as n,r as o,d as y,e as m,f as M,g as d,o as q}from"./index-YvoSsj8_.js";const _=h.create({baseURL:"/api",timeout:5e3}),B=()=>_.get("/users"),L=l=>_.post("/users",l),N=(l,t)=>_.put(`/users/${l}`,t),R=l=>_.delete(`/users/${l}`),z={name:"Users",components:{PlusOutlined:V,EditOutlined:D,DeleteOutlined:I},setup(){const l=m([]),t=m(!1),i=m(!1),e=m({username:"",email:""}),U=[{title:"ID",dataIndex:"id",key:"id"},{title:"用户名",dataIndex:"username",key:"username"},{title:"邮箱",dataIndex:"email",key:"email"},{title:"创建时间",dataIndex:"created_at",key:"created_at"},{title:"操作",key:"action",slots:{customRender:"action"},width:150}],u=async()=>{try{const r=await B();l.value=r.data}catch{d.error("获取用户列表失败")}},p=()=>{i.value=!1,e.value={username:"",email:""},t.value=!0},c=r=>{i.value=!0,e.value={...r},t.value=!0},f=async()=>{try{i.value?(await N(e.value.id,e.value),d.success("用户更新成功")):(await L(e.value),d.success("用户添加成功")),t.value=!1,u()}catch{d.error(i.value?"用户更新失败":"用户添加失败")}},v=()=>{t.value=!1},k=async r=>{try{await R(r),d.success("用户删除成功"),u()}catch{d.error("用户删除失败")}};return M(()=>{u()}),{users:l,columns:U,modalVisible:t,isEdit:i,form:e,showModal:p,editUser:c,handleOk:f,handleCancel:v,deleteUser:k}}},S={class:"users"};function T(l,t,i,e,U,u){const p=o("PlusOutlined"),c=o("a-button"),f=o("a-page-header"),v=o("EditOutlined"),k=o("DeleteOutlined"),r=o("a-space"),O=o("a-table"),C=o("a-input"),b=o("a-form-item"),g=o("a-form"),w=o("a-modal");return q(),P("div",S,[a(f,{class:"site-page-header",title:"用户管理","sub-title":"管理系统用户信息"},{extra:n(()=>[a(c,{type:"primary",onClick:e.showModal},{icon:n(()=>[a(p)]),default:n(()=>[t[3]||(t[3]=y(" 添加用户 ",-1))]),_:1},8,["onClick"])]),_:1}),a(O,{columns:e.columns,"data-source":e.users,pagination:{pageSize:10},"row-key":s=>s.id},{action:n(({record:s})=>[a(r,null,{default:n(()=>[a(c,{type:"link",onClick:x=>e.editUser(s)},{icon:n(()=>[a(v)]),default:n(()=>[t[4]||(t[4]=y(" 编辑 ",-1))]),_:1},8,["onClick"]),a(c,{type:"link",danger:"",onClick:x=>e.deleteUser(s.id)},{icon:n(()=>[a(k)]),default:n(()=>[t[5]||(t[5]=y(" 删除 ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:1},8,["columns","data-source","row-key"]),a(w,{open:e.modalVisible,"onUpdate:open":t[2]||(t[2]=s=>e.modalVisible=s),title:e.isEdit?"编辑用户":"添加用户",onOk:e.handleOk,onCancel:e.handleCancel},{default:n(()=>[a(g,{model:e.form,layout:"vertical"},{default:n(()=>[a(b,{label:"用户名",rules:[{required:!0,message:"请输入用户名"}]},{default:n(()=>[a(C,{value:e.form.username,"onUpdate:value":t[0]||(t[0]=s=>e.form.username=s),placeholder:"请输入用户名"},null,8,["value"])]),_:1}),a(b,{label:"邮箱",rules:[{required:!0,message:"请输入邮箱",type:"email"}]},{default:n(()=>[a(C,{value:e.form.email,"onUpdate:value":t[1]||(t[1]=s=>e.form.email=s),placeholder:"请输入邮箱"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","onOk","onCancel"])])}const F=E(z,[["render",T],["__scopeId","data-v-e476a3f0"]]);export{F as default};
